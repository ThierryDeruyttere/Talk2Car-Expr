# A-REG 

## Requirements

```
pytorch==1.7.1
pytorch-lightning==1.0.8
pycocotools
nltk
```

## Preprocessing

Download glove embeddings
```
wget https://nlp.stanford.edu/data/glove.840B.300d.zip && unzip glove.840B.300d.zip
```

then in `preprocess_t2c_features.py` set the path to the talk2car images.
Afterward, run:

```
python preprocess_t2c_features.py
```

Some files used by the program above are generated by `../generate_questions_simple/extract_counts_gt.py` and the attribute_prediction model (it saves the predictions automatically) but as we provide pre-generated files we do not go deeper into that script.

Next train the A-REG model:

```
main.py --prepend_name reg_v2_clean_run --gpus 1 --dataset t2c --max_len 15 --batch_size_train 16 --max_attrs 1 --max_epochs 125 --num_workers 12 --lstm_hidden 512 --feature_hidden 512 --attention_hidden 256 --attribute_prob2hot True --switch_loss_weight 1 --switch_loss mse --mmi_loss_margin 1 --use_img True --use_box True --use_count True --use_attr_hot True --use_class_hot True --use_class_mod True --use_bert False --use_diff True --mmi_loss_version v2 --llambda_weight=1 --mmi_loss_weight=0.2 --seed=111 --use_reinforcer= --vlambda_weight=0
```